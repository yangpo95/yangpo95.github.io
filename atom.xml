<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Paul&#39;s Blog</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2021-09-06T13:31:20.685Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>Paul Yang</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>kernel_build</title>
    <link href="http://example.com/2021/01/18/kernel_build/"/>
    <id>http://example.com/2021/01/18/kernel_build/</id>
    <published>2021-01-17T14:43:47.000Z</published>
    <updated>2021-09-06T13:31:20.685Z</updated>
    
    <content type="html"><![CDATA[<h1 id="内核编译"><a href="#内核编译" class="headerlink" title="内核编译"></a>内核编译</h1><h2 id="kernel编译步骤"><a href="#kernel编译步骤" class="headerlink" title="kernel编译步骤"></a>kernel编译步骤</h2><h2 id="Linux-内核配置系统"><a href="#Linux-内核配置系统" class="headerlink" title="Linux 内核配置系统"></a>Linux 内核配置系统</h2><p>Linux 内核配置系统由三个部分组成。</p><ul><li>Makefile 文件：分布在 Linux 内核源码中的 Makefile 文件，定义了 Linux 内核的编译规则。<a id="more"></a></li><li>Kconfig 文件：给用户提供配置选择的功能。</li><li>配置工具：这里使用的是 menuconfig，相比其它工具，这个工具使用的比较多。<ul><li>make config，这是基于文本的最为传统的配置界面，不推荐使用。</li><li>make menuconfig，基于文本菜单的配置界面，不依赖于QT或GTK+，且非常直观。</li><li>make xconfig，要求 安装QT，用的比较少。</li><li>make gconfig，要求 安装GTK，用的比较少。</li></ul></li></ul><h2 id="Linux-内核顶层-Makefile"><a href="#Linux-内核顶层-Makefile" class="headerlink" title="Linux 内核顶层 Makefile"></a>Linux 内核顶层 Makefile</h2><p>顶层 Makefile 控制着 Linux 内核的编译流程，正在整理中。。。</p><h2 id="Menuconfig的操作"><a href="#Menuconfig的操作" class="headerlink" title="Menuconfig的操作"></a>Menuconfig的操作</h2><h3 id="config文件和menuconfig的关系"><a href="#config文件和menuconfig的关系" class="headerlink" title=".config文件和menuconfig的关系"></a>.config文件和menuconfig的关系</h3><p>以 leds 小灯的驱动配置为例，介绍 menuconfig 具体执行过程。</p><p>在修改之前，.config里配置如下：</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONFIG_LEDS_CTL=y</span><br></pre></td></tr></table></figure><p>打开menuconfig 配置界面，如下：</p><p><img src="/2021/01/18/kernel_build/menuconfig_1.PNG" alt="1"></p><p>现按‘N’取消“Enable LEDS config ”配置，如下：</p><p><img src="/2021/01/18/kernel_build/menuconfig_2.PNG" alt="2"></p><p>.config里配置变成如下：</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># CONFIG_LEDS_CTL is not set</span></span><br></pre></td></tr></table></figure><h3 id="Kconfig和menuconfig的关系"><a href="#Kconfig和menuconfig的关系" class="headerlink" title="Kconfig和menuconfig的关系"></a>Kconfig和menuconfig的关系</h3><p>打开源码下的“drivers/char/Kconfig ”文件，如下：</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">config LEDS_CTL                                                                 </span><br><span class="line">bool <span class="string">&quot;Enable LEDS config&quot;</span></span><br><span class="line">default y</span><br><span class="line">help</span><br><span class="line">  Enable LEDS config</span><br></pre></td></tr></table></figure><p>这里的 config LEDS_CTL 就和 menuconfig 图形配置界面中“Enable LEDS config”对应如下:</p><p><img src="/2021/01/18/kernel_build/menuconfig_1.PNG" alt="3"></p><p>在“drivers/char/Kconfig ”文件的第一行，有个menu如下：</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">menu <span class="string">&quot;Character devices&quot;</span></span><br></pre></td></tr></table></figure><p>这个”Character devices”和menuconfig的菜单对应，如下：</p><p><img src="/2021/01/18/kernel_build/menuconfig_3.PNG" alt="4"></p><p>然后在“drivers/Kconfig”文件里，有个menu, 且有个source包含了”drivers/char/Kconfig”，如下:</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">menu <span class="string">&quot;Device Drivers&quot;</span></span><br><span class="line">source <span class="string">&quot;drivers/char/Kconfig&quot;</span></span><br></pre></td></tr></table></figure><p>即“Character devices”的上一级菜单”Device Drivers”，menuconfig的菜单如下：</p><p><img src="/2021/01/18/kernel_build/menuconfig_4.PNG" alt="5"></p><p>最后顶层的 Kconfig 文件， 如下：</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># For a description of the syntax of this configuration file,</span></span><br><span class="line"><span class="comment"># see Documentation/kbuild/kconfig-language.txt.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">mainmenu <span class="string">&quot;Linux/$ARCH $KERNELVERSION Kernel Configuration&quot;</span></span><br><span class="line"></span><br><span class="line">config SRCARCH</span><br><span class="line">string</span><br><span class="line">option env=<span class="string">&quot;SRCARCH&quot;</span></span><br><span class="line"></span><br><span class="line">source <span class="string">&quot;arch/$SRCARCH/Kconfig&quot;</span></span><br></pre></td></tr></table></figure><ul><li><p>mainmenu “Linux/$ARCH $KERNELVERSION Kernel Configuration”是主菜单的的标题。</p></li><li><p>$ARCH 是定义在 Makefile 中的一个变量，这里配置是arm如下：</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ARCH ?= arm</span><br></pre></td></tr></table></figure></li><li><p>KERNELVERSION 是内核版本号，在Makefile里配置如下：</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">VERSION = 3                                                               </span><br><span class="line">PATCHLEVEL = 0</span><br><span class="line">SUBLEVEL = 15</span><br><span class="line">EXTRAVERSION =</span><br><span class="line">KERNELVERSION = <span class="variable">$(VERSION)</span><span class="variable">$(<span class="built_in">if</span> <span class="variable">$(PATCHLEVEL)</span>,.<span class="variable">$(PATCHLEVEL)</span>$(<span class="built_in">if</span> <span class="variable">$(SUBLEVEL)</span>,.<span class="variable">$(SUBLEVEL)</span>)</span>)<span class="variable">$(EXTRAVERSION)</span> </span><br></pre></td></tr></table></figure></li><li><p>$SRCARCH 和 ARCH 一样，在 Makefile 中定义如下：</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SRCARCH:= <span class="variable">$(ARCH)</span></span><br></pre></td></tr></table></figure></li></ul><p><img src="/2021/01/18/kernel_build/menuconfig_5.PNG" alt="6"></p><h3 id="Kconfig的基础语法"><a href="#Kconfig的基础语法" class="headerlink" title="Kconfig的基础语法"></a>Kconfig的基础语法</h3><p>内核配置脚本文件的语法也比较简单，主要包括如下几个方面。</p><ul><li><p>配置选项，即config，每个配置选项都必须指定类型，类型包括bool、tristate、string、hex和int，其中tristate和string是两种<br>基本类型，其他类型都基于这两种基本类型。</p><ul><li><strong>bool:</strong>   表示该CONFIG宏只能选择y(编译内核)或者n(不编译)</li><li><strong>tristate:</strong> 表示该CONFIG宏可以设置y/m/n三种模式(tristate)，m代表编译为模块</li><li><strong>string:</strong>  表示该CONFIG宏可以设为一串字符,比如**#define CONFIG_XXX “config test”**</li><li><strong>hex:</strong>    表示该CONFIG宏可以设为一个十六进制,比如**#define CONFIG_XXX 0x1234**</li><li><strong>int:</strong>     表示该CONFIG宏可以设为一个整数,比如**#define CONFIG_XXX 1234**</li></ul></li><li><p>菜单结构，即menu，配置选项在菜单树结构中的位置可由两种方法决定。</p><p>第一种，所有处于“menu”和“endmenu”之间的配置选项都会成”Device Drivers”的子菜单,且所有子菜单（config）选项都会继承父菜单（menu）的依赖关系。如下：</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">menu <span class="string">&quot;Device Drivers&quot;</span></span><br><span class="line">source <span class="string">&quot;drivers/base/Kconfig&quot;</span></span><br><span class="line">source <span class="string">&quot;drivers/connector/Kconfig&quot;</span></span><br><span class="line">.....</span><br><span class="line">endmenu</span><br></pre></td></tr></table></figure><p>第二种，通过分析依赖关系生成菜单结构，MODVERSIONS直接依赖MODULES，只有MODULES不为“n”时，该选项才可见。如下:</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">config MODULES</span><br><span class="line">bool <span class="string">&quot;Enable loadable module support&quot;</span></span><br><span class="line">config MODVERSIONS</span><br><span class="line">bool <span class="string">&quot;Set version information on all module symbols&quot;</span></span><br><span class="line">depends on MODULES</span><br><span class="line">comment <span class="string">&quot;module support disabled&quot;</span></span><br><span class="line">depends on !MODULES</span><br></pre></td></tr></table></figure></li><li><p>depends on:依赖项，反向依赖select，关系如下 </p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">config A</span><br><span class="line">    depends on B</span><br><span class="line">    select C</span><br></pre></td></tr></table></figure><p>  只有当CONFIG_B配置为Y时，CONFIG_A就会被配置成Y，然后CONFIG_C也就被配置成Y。</p></li><li><p>choice 语句将多个类似的配置选项组合在一起，供用户选择一组配置项。</p></li></ul>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;内核编译&quot;&gt;&lt;a href=&quot;#内核编译&quot; class=&quot;headerlink&quot; title=&quot;内核编译&quot;&gt;&lt;/a&gt;内核编译&lt;/h1&gt;&lt;h2 id=&quot;kernel编译步骤&quot;&gt;&lt;a href=&quot;#kernel编译步骤&quot; class=&quot;headerlink&quot; title=&quot;kernel编译步骤&quot;&gt;&lt;/a&gt;kernel编译步骤&lt;/h2&gt;&lt;h2 id=&quot;Linux-内核配置系统&quot;&gt;&lt;a href=&quot;#Linux-内核配置系统&quot; class=&quot;headerlink&quot; title=&quot;Linux 内核配置系统&quot;&gt;&lt;/a&gt;Linux 内核配置系统&lt;/h2&gt;&lt;p&gt;Linux 内核配置系统由三个部分组成。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Makefile 文件：分布在 Linux 内核源码中的 Makefile 文件，定义了 Linux 内核的编译规则。&lt;/li&gt;&lt;/ul&gt;</summary>
    
    
    
    
    <category term="kernel" scheme="http://example.com/tags/kernel/"/>
    
  </entry>
  
  <entry>
    <title>How to set up OpenGrok in ubuntu</title>
    <link href="http://example.com/2020/09/06/OpenGrok-build/"/>
    <id>http://example.com/2020/09/06/OpenGrok-build/</id>
    <published>2020-09-06T12:34:43.000Z</published>
    <updated>2021-08-22T14:58:21.354Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Ubuntu"><a href="#Ubuntu" class="headerlink" title="Ubuntu"></a>Ubuntu</h1><h2 id="Install-opengrok"><a href="#Install-opengrok" class="headerlink" title="Install opengrok"></a>Install opengrok</h2><p><a href="https://github.com/oracle/opengrok/releases">https://github.com/oracle/opengrok/releases</a></p><h2 id="Install-Tomcat"><a href="#Install-Tomcat" class="headerlink" title="Install Tomcat"></a>Install Tomcat</h2><p> <a href="https://tomcat.apache.org/">https://tomcat.apache.org/</a></p><h2 id="Install-JDK"><a href="#Install-JDK" class="headerlink" title="Install JDK"></a>Install JDK</h2><p>sudo apt install openjdk-8-jdk</p><h2 id="Install-ctags"><a href="#Install-ctags" class="headerlink" title="Install ctags"></a>Install ctags</h2><p>sudo apt-get install ctags</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Ubuntu&quot;&gt;&lt;a href=&quot;#Ubuntu&quot; class=&quot;headerlink&quot; title=&quot;Ubuntu&quot;&gt;&lt;/a&gt;Ubuntu&lt;/h1&gt;&lt;h2 id=&quot;Install-opengrok&quot;&gt;&lt;a href=&quot;#Install-opengrok&quot; cla</summary>
      
    
    
    
    <category term="Tools" scheme="http://example.com/categories/Tools/"/>
    
    
    <category term="tool" scheme="http://example.com/tags/tool/"/>
    
  </entry>
  
  <entry>
    <title>How to set up a blog by hexo</title>
    <link href="http://example.com/2020/09/06/hexo/"/>
    <id>http://example.com/2020/09/06/hexo/</id>
    <published>2020-09-06T04:28:52.000Z</published>
    <updated>2020-09-06T09:41:54.348Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Install-hexo"><a href="#Install-hexo" class="headerlink" title="Install hexo"></a>Install hexo</h1><ul><li>install nodejs</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install nodejs</span><br><span class="line">sudo apt install nodejs-legacy</span><br><span class="line">sudo apt install npm</span><br></pre></td></tr></table></figure><ul><li>change the Mirror</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure><ul><li>install the update-version tool ‘n’</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install n -g</span><br><span class="line">sudo n stable</span><br></pre></td></tr></table></figure><ul><li>install hexo</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install -g hexo</span><br></pre></td></tr></table></figure><h1 id="Push-to-the-github-page"><a href="#Push-to-the-github-page" class="headerlink" title="Push to the github page"></a>Push to the github page</h1><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://blog.csdn.net/y5492853/article/details/79529410">https://blog.csdn.net/y5492853/article/details/79529410</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Install-hexo&quot;&gt;&lt;a href=&quot;#Install-hexo&quot; class=&quot;headerlink&quot; title=&quot;Install hexo&quot;&gt;&lt;/a&gt;Install hexo&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;install nodejs&lt;/li&gt;
&lt;/ul</summary>
      
    
    
    
    <category term="Tools" scheme="http://example.com/categories/Tools/"/>
    
    
    <category term="tool" scheme="http://example.com/tags/tool/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://example.com/2020/09/06/hello-world/"/>
    <id>http://example.com/2020/09/06/hello-world/</id>
    <published>2020-09-06T04:22:09.734Z</published>
    <updated>2020-09-06T04:22:09.734Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot;&gt;documentation&lt;/a&gt; for</summary>
      
    
    
    
    
  </entry>
  
</feed>
